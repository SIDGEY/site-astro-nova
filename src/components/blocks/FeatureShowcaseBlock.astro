---
import Section from '../Section.astro';
import type { BgVariant } from '../../utils/bgHelper';

interface ShowcaseTag {
  label?: string;
  image?: string;
  imageAlt?: string;
}

interface ShowcaseScreen {
  image: string;
  imageAlt?: string;
}

interface ShowcaseItem {
  eyebrow?: string;
  title: string;
  description: string;
  align?: 'left' | 'right';
  backgroundImage: string;
  backgroundImageAlt?: string;
  screens?: ShowcaseScreen[];
  tags?: ShowcaseTag[];
  ctaLabel?: string;
  ctaLink?: string;
}

interface Props {
  title?: string;
  subtitle?: string;
  items: ShowcaseItem[];
  bgVariant?: BgVariant;
}

const { title, subtitle, items = [], bgVariant } = Astro.props;
---

<Section variant={bgVariant || 'surface'}>
  <div class="space-y-8 md:space-y-12">
    {(title || subtitle) && (
      <header class="max-w-3xl space-y-3">
        {title && <h2 class="text-3xl md:text-4xl font-bold text-text">{title}</h2>}
        {subtitle && <p class="text-lg text-muted">{subtitle}</p>}
      </header>
    )}

    <div class="space-y-4 md:space-y-6">
      {items.map((item) => {
        const isRight = item.align === 'right';

        return (
          <article class="relative isolate overflow-hidden rounded-3xl border border-border/50 bg-[#060f24] min-h-[420px]">
            <img
              src={item.backgroundImage}
              alt={item.backgroundImageAlt || item.title}
              class="absolute inset-0 h-full w-full object-cover"
              loading="lazy"
            />

            <div
              class:list={[
                'absolute inset-0',
                isRight
                  ? 'bg-[linear-gradient(90deg,rgba(4,10,22,0.72)_0%,rgba(4,10,22,0.45)_36%,rgba(4,10,22,0.92)_74%,rgba(4,10,22,0.98)_100%)]'
                  : 'bg-[linear-gradient(90deg,rgba(4,10,22,0.98)_0%,rgba(4,10,22,0.92)_38%,rgba(4,10,22,0.45)_64%,rgba(4,10,22,0.72)_100%)]',
              ]}
              aria-hidden="true"
            ></div>

            <div class="relative z-10 grid min-h-[420px] items-center gap-10 px-6 py-10 md:grid-cols-12 md:px-10 md:py-14 lg:px-14">
              <div class:list={[
                'space-y-5 md:col-span-5',
                isRight ? 'md:order-2 md:pl-6' : 'md:order-1 md:pr-6',
              ]}>
                {item.eyebrow && <p class="text-xs font-semibold uppercase tracking-[0.18em] text-primary-contrast/80">{item.eyebrow}</p>}
                <h3 class="text-3xl md:text-5xl font-bold text-white leading-tight">{item.title}</h3>
                <p class="text-base md:text-xl leading-relaxed text-slate-200/95">{item.description}</p>

                {(item.ctaLabel && item.ctaLink) && (
                  <a
                    href={item.ctaLink}
                    class="inline-flex items-center rounded-lg border border-white/25 bg-white/10 px-5 py-2.5 text-sm font-semibold text-white transition hover:bg-white/20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary"
                  >
                    {item.ctaLabel}
                  </a>
                )}

                {!!item.tags?.length && (
                  <div class="flex flex-wrap gap-2 pt-2">
                    {item.tags.map((tag) => (
                      <span class="inline-flex h-11 w-11 items-center justify-center overflow-hidden rounded-md border border-white/20 bg-slate-900/45 text-sm font-semibold text-slate-100">
                        {tag.image ? (
                          <img src={tag.image} alt={tag.imageAlt || tag.label || 'Tag'} class="h-full w-full object-cover" loading="lazy" />
                        ) : (
                          <span>{tag.label}</span>
                        )}
                      </span>
                    ))}
                  </div>
                )}
              </div>

              <div class:list={[
                'md:col-span-7 flex flex-wrap items-end justify-center gap-4 md:gap-6',
                isRight ? 'md:order-1' : 'md:order-2',
              ]}>
                {item.screens?.map((screen) => (
                  <div class="w-[160px] md:w-[210px] rounded-[22px] border border-white/15 bg-slate-950/50 p-2 shadow-2xl shadow-black/40">
                    <img
                      src={screen.image}
                      alt={screen.imageAlt || item.title}
                      class="h-[260px] md:h-[340px] w-full rounded-[16px] object-cover"
                      loading="lazy"
                    />
                  </div>
                ))}
              </div>
            </div>
          </article>
        );
      })}
    </div>
  </div>
</Section>
